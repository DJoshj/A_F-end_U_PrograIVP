<div class="container mt-4">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h2>Editar Materia Asignada</h2>
      <button class="btn btn-secondary" (click)="goBack()">
        <mat-icon>arrow_back</mat-icon> Volver
      </button>
    </div>
    <div class="card-body">
      <div *ngIf="isLoading" class="text-center">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <p>Cargando materia...</p>
      </div>
      @if (erroMSG) {
        <div>{{erroMSG}}</div>
      }


      <form [formGroup]="editSubjectForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading && !erroMSG">
        <div class="">
          <label for="subjectId" class="form-label">ID de Materia</label>
          <input type="text" id="subjectId" formControlName="subjectId" class="form-control" readonly>
        </div>

        <div class="">
          <label for="subjectName" class="form-label">Nombre de Materia</label>
          <input type="text" id="subjectName" formControlName="subjectName" class="form-control" readonly>
        </div>

        <div class="">
          <label for="teacherId" class="form-label">Docente</label>
          <select id="teacherId" formControlName="teacherId" class="form-select"
                  [class.is-invalid]="editSubjectForm.get('teacherId')?.invalid && editSubjectForm.get('teacherId')?.touched">
            <option [ngValue]="null" disabled>Seleccione un docente</option>
            <option *ngFor="let teacher of teachers" [ngValue]="teacher.teacherId">{{ teacher.names }} {{ teacher.lastName }}</option>
          </select>
          <div *ngIf="editSubjectForm.get('teacherId')?.invalid && editSubjectForm.get('teacherId')?.touched" class="invalid-feedback">
            Docente es requerido.
          </div>
        </div>

        <div class="">
          <label for="periodId" class="form-label">Periodo</label>
          <select id="periodId" formControlName="periodId" class="form-select"
                  [class.is-invalid]="editSubjectForm.get('periodId')?.invalid && editSubjectForm.get('periodId')?.touched">
            <option [ngValue]="null" disabled>Seleccione un periodo</option>
            <option *ngFor="let period of periods" [ngValue]="period.periodId">{{ period.name }} ({{ period.year }})</option>
          </select>
          <div *ngIf="editSubjectForm.get('periodId')?.invalid && editSubjectForm.get('periodId')?.touched" class="invalid-feedback">
            Periodo es requerido.
          </div>
        </div>

        <div class="">
          <label for="classroomId" class="form-label">Aula</label>
          <select id="classroomId" formControlName="classroomId" class="form-select"
                  [class.is-invalid]="editSubjectForm.get('classroomId')?.invalid && editSubjectForm.get('classroomId')?.touched">
            <option [ngValue]="null" disabled>Seleccione un aula</option>
            <option *ngFor="let classroom of classrooms" [ngValue]="classroom.classroomId">{{ classroom.name }} ({{ classroom.building }})</option>
          </select>
          <div *ngIf="editSubjectForm.get('classroomId')?.invalid && editSubjectForm.get('classroomId')?.touched" class="invalid-feedback">
            Aula es requerida.
          </div>
        </div>

        <div class="">
          <label for="scheduleId" class="form-label">Horario</label>
          <select id="scheduleId" formControlName="scheduleId" class="form-select"
                  [class.is-invalid]="editSubjectForm.get('scheduleId')?.invalid && editSubjectForm.get('scheduleId')?.touched">
            <option [ngValue]="null" disabled>Seleccione un horario</option>
            <option *ngFor="let schedule of availableSchedules" [ngValue]="schedule.scheduleId">{{ schedule.days }} {{ schedule.schedule }}</option>
          </select>
          <div *ngIf="editSubjectForm.get('scheduleId')?.invalid && editSubjectForm.get('scheduleId')?.touched" class="invalid-feedback">
            Horario es requerido.
          </div>
        </div>

        <div class="">
          <label for="maximumCapacity" class="form-label">Capacidad M치xima</label>
          <input type="number" id="maximumCapacity" formControlName="maximumCapacity" class="form-control"
                 [class.is-invalid]="editSubjectForm.get('maximumCapacity')?.invalid && editSubjectForm.get('maximumCapacity')?.touched">
          <div *ngIf="editSubjectForm.get('maximumCapacity')?.invalid && editSubjectForm.get('maximumCapacity')?.touched" class="invalid-feedback">
            Capacidad m치xima es requerida y debe ser mayor a 0.
          </div>
        </div>

        <div class="">
          <label for="section" class="form-label">Secci칩n</label>
          <input type="text" id="section" formControlName="section" class="form-control"
                 [class.is-invalid]="editSubjectForm.get('section')?.invalid && editSubjectForm.get('section')?.touched">
          <div *ngIf="editSubjectForm.get('section')?.invalid && editSubjectForm.get('section')?.touched" class="invalid-feedback">
            Secci칩n es requerida.
          </div>
        </div>

        <button type="submit" class="btn btn-primary" [disabled]="editSubjectForm.invalid">Guardar Cambios</button>
      </form>
    </div>
  </div>
</div>
